import numpy as np

# ============================== 常用常数参数 ==============================
pai = 3.1415926535897931  # π
mu0 = 4.0 * pai * 1e-07    # 真空磁导率
c_vac = 2.99792458e8       # 真空中光速
epsilon0 = 1.0 / (c_vac**2 * mu0)  # 真空介电常数


# ============================== 计算配置参数 ==============================
# 网格与分层参数
mx = None  # x方向的cell个数（未读取前为None）
mz = None  # z方向的cell个数
xx1 = None  # 第一个网格中心的x坐标
zz1 = None  # 第一个网格中心的z坐标
dx = None   # x方向的网格步长
dz = None   # z方向的网格步长
nlayer = None  # 分层的个数
ntrtot = None  # 发射点源的个数
nrectot = None  # 接收点的个数
nfreq = None    # 频率点的个数
pec_first = None  # 第一层是否为PEC
pec_last = None   # 最后一层是否为PEC

# 层属性数组（初始化为None，后续分配）
ttcer = None               # 每层的相对介电常数（real数组）
ttmiur = None              # 每层的相对磁导率（real数组）
xsig = None                # 每层的电导率（real数组）
xloc = None                # 分层界面位置（real数组，0:nlayer-1）
cer = None                 # 当前频率下的复数相对介电常数（complex数组）
mur = None                 # 当前频率下的复数相对磁导率（complex数组）
ck = None                  # 每层的波数

# 接收点与频率参数
xrr, zrr = None, None      # 接收点坐标（real数组）
freq = None                # 频率数组（real数组）
layerofscat = None  # 散射体所在分层
startx = None       # 散射体x起始位置
endx = None         # 散射体x结束位置
startz = None       # 散射体z起始位置
endz = None         # 散射体z结束位置

# 散射体属性
scatepsr = None            # 散射体的相对介电常数（real数组，mx×mz）
scatmur = None             # 散射体的相对磁导率（real数组，mx×mz）
scatsigma = None           # 散射体的电导率（real数组，mx×mz）
epslonbr = None            # 散射体所在背景的复数介电常数（complex数组，nfreq）
xkai = None                # 对比度（complex数组，mx×mz×nfreq）
xk = None                  # 背景波数（complex数组，nfreq）
theta_inc = None           # 入射角数组（real数组）


# ============================== BCGS迭代参数 ==============================
maxistep = None               # 最大迭代步数
maxresidualerror = None       # 残差最大值


# ============================== 积分配置参数 ==============================
nsegmax = 20000            # Sommerfeld积分最大分段数（原parameter参数）
nEHJ = 3                   # G^EHJ的独立空间域数量（原parameter参数）
nIntPoint = 32             # 高斯积分点数（32点，原parameter参数）
krhomax = 1.0e32           # 渐近反射系数计算的阈值（原parameter参数）


# ============================== 格林函数插值参数 ==============================
mxymax = None   # 对角线上的点数
mxyunit = None  # 单位波长点数


# ============================== FFT加速参数 ==============================
dxz = None      # 网格面积
acx = None      # 归一化系数
acz = None      # 归一化系数


# ============================== 积分容差参数 ==============================
tolerance1 = 1.0e-5        # 容差1（原parameter参数）
tolerance2 = 1.0e-3        # 容差2（原parameter参数）


# ============================== 反射系数计算参数 ==============================
# dR_leftTE, dR_leftTM = 0j, 0j
# ...


# ============================== 全局共用变量 ==============================
xomega = None        # 角频率
k_max = None         # 最大波数
nfield = None        # 场数量


# ============================== 32点高斯积分点 ==============================
XU = np.array([
    0.136806908e-02,   0.719424423e-02,   0.176188722e-01,   0.325469620e-01,
    0.518394221e-01,   0.753161931e-01,   0.102758102e+00,   0.133908941e+00,
    0.168477867e+00,   0.206142121e+00,   0.246550046e+00,   0.289324362e+00,
    0.334065699e+00,   0.380356319e+00,   0.427764019e+00,   0.475846167e+00,
    0.524153833e+00,   0.572235981e+00,   0.619643681e+00,   0.665934301e+00,
    0.710675638e+00,   0.753449954e+00,   0.793857879e+00,   0.831522133e+00,
    0.866091059e+00,   0.897241898e+00,   0.924683807e+00,   0.948160578e+00,
    0.967453038e+00,   0.982381128e+00,   0.992805756e+00,   0.998631931e+00
], dtype=np.float64)